"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[466],{465:(e,t,o)=>{o.d(t,{A:()=>r});o(43);const n="container_conatiner__xS-Ti";var s=o(579);const r=e=>(0,s.jsx)("div",{className:n,children:e.children})},466:(e,t,o)=>{o.r(t),o.d(t,{default:()=>_});var n=o(43),s=o(749),r=o(465),c=o(240);const a="comment_li__2JHqy",i="comment_ptext__Ta5Xz",l="comment_inputfield__HwSfO";var d=o(213),p=o(579);const u=e=>{const[t,o]=(0,n.useState)([]),[s,u]=(0,n.useState)(""),h=e.pollId,m=(0,n.useContext)(c.A).token;(0,n.useEffect)((()=>{(async()=>{try{const e=await d.A.get("https://deployevelocity-project.onrender.com/api/v1/comments/".concat(h),{headers:{Authorization:m}});o(e.data.data.comments)}catch(e){console.error("Error fetching comments:",e)}})()}),[h,m]);return(0,p.jsxs)(r.A,{children:[(0,p.jsx)("h2",{children:"Comments"}),(0,p.jsx)("ul",{children:t.map(((e,t)=>(0,p.jsxs)("li",{className:a,children:[(0,p.jsx)("p",{className:i,children:e.text}),(0,p.jsx)("p",{children:(0,p.jsxs)("small",{children:["By ",e.user.username]})})]},t)))}),(0,p.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e={content:s};201!==(await d.A.post("https://deployevelocity-project.onrender.com/api/v1/comments/".concat(h),e,{headers:{Authorization:m}})).status&&alert("somthing went wrong"),u("");const t=await d.A.get("https://deployevelocity-project.onrender.com/api/v1/comments/".concat(h),{headers:{Authorization:m}});o(t.data.data.comments)}catch(t){console.error("Error posting comment:",t)}},children:[(0,p.jsx)("textarea",{className:l,value:s,onChange:e=>u(e.target.value),placeholder:"Write a comment..."}),(0,p.jsx)("button",{type:"submit",children:"Submit"})]})]})},h="votepage_optionlist__vXidh",m="votepage_options__yAUoC",v="votepage_conatiner2__tkIjk",j="votepage_btn__duOHz",_=()=>{const[e,t]=(0,n.useState)({}),[o,a]=(0,n.useState)([]),[i,l]=(0,n.useState)(!1),_=(0,n.useContext)(c.A),x=_.token,y=(0,n.useRef)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await fetch("https://deployevelocity-project.onrender.com/api/v1/polls/create",{headers:{Authorization:x}}),o=await e.json();a(o.data);const n={};o.data.forEach((e=>{"object"===typeof e.voteCounts&&null!==e.voteCounts&&(n[e._id]=e.voteCounts)})),t(n)}catch(e){console.error("Error fetching polls:",e)}})()}),[x]),(0,n.useEffect)((()=>{if(!y.current)return y.current=(0,s.Ay)("https://deployevelocity-project.onrender.com",{query:{token:x}}),y.current.on("voteUpdate",(e=>{let{pollId:o,voteCounts:n}=e;t((e=>({...e,[o]:n})))})),y.current.on("voteError",(e=>{let{message:t}=e;console.error("Error:",t)})),()=>{y.current.disconnect()}}),[x]);return(0,p.jsx)("div",{children:o.map((o=>(0,p.jsxs)(r.A,{className:v,children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{children:o.question}),(0,p.jsx)("div",{className:h,children:o.options.map(((n,s)=>{var r;return(0,p.jsxs)("button",{className:m,onClick:()=>(async(e,o)=>{y.current.emit("vote",{pollId:e,option:o});try{await d.A.post("https://deployevelocity-project.onrender.com/api/v1/votes",{pollId:e,option:o,userId:_.userId},{headers:{Authorization:x}}),t((t=>{const n={...t};return n[e]||(n[e]={}),n[e][o]||(n[e][o]=0),n[e][o]+=1,n}))}catch(n){alert(n.response.data.message)}})(o._id,n),children:[(0,p.jsx)("span",{children:n}),(0,p.jsx)("span",{children:(null===(r=e[o._id])||void 0===r?void 0:r[n])||0})]},s)}))})]}),(0,p.jsx)("button",{className:j,onClick:()=>l((e=>!e)),children:"comments"}),i&&(0,p.jsx)(u,{pollId:o._id})]},o._id)))})}}}]);
//# sourceMappingURL=466.9ac29eaf.chunk.js.map